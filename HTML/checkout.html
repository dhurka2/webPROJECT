<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout</title>
  <link rel="stylesheet" href="https://dhurka2.github.io/webPROJECT/styles/checkout.css"
</head>
<body class="dc-thebody">
  <div id="cartInfo"></div>

  <form id="checkoutForm" class="dc-theform">
    
    <input type="hidden" id="price" name="price" value="0.00">

    <label for="name" class="dc-thelabel">Name:</label>
    <input type="text" id="name" name="name" class="dc-theinput" required>

    <label for="surname" class="dc-thelabel">Surname:</label>
    <input type="text" id="surname" name="surname" class="dc-theinput" required>

    <label for="address" class="dc-thelabel">Address:</label>
    <input type="text" id="address" name="address" class="dc-theinput" required>

    <label for="paymentMethod" class="dc-thelabel">Payment Method:</label>
    <select id="paymentMethod" name="paymentMethod" class="dc-theselect" required>
      <option value="creditCard">Credit Card</option>
      <option value="cash">Cash</option>
    </select>
    <label for="promocode" class="dc-thelabel">Promo Code:</label>
    <input type="text" id="promocode" name="promocode" class="dc-theinput">
     <button type="button" id="applyButton" class="dc-thebutton" onclick="applyPromoCode()">Apply</button>
    <button type="button" id="orderButton" class="dc-thebutton" onclick="placeOrder()">Order</button>
  </form>

 <script>
    document.addEventListener("DOMContentLoaded", function () {
    const priceInput = document.getElementById('price');
    const totalPriceElement = document.getElementById('totalPrice');

    // Retrieve the original price and set it in the hidden input field
    const originalPrice = parseFloat(priceInput.value);
    
    const storedTotalAmount = sessionStorage.getItem('totalAmount');
    
    if (storedTotalAmount) {
        totalPriceElement.textContent = storedTotalAmount;
    }

    function resetToOriginalPrice() {
        priceInput.value = originalPrice.toFixed(2);
        totalPriceElement.textContent = `$${originalPrice.toFixed(2)}`;
    }

    // Reset the price when leaving the page
    window.addEventListener('beforeunload', function() {
        resetToOriginalPrice();
    });
});

function applyPromoCode() {
    const promoCodeInput = document.getElementById('promocode');
    const promoCode = promoCodeInput.value.trim().toLowerCase();

    // Retrieve the original price from the hidden input field
    const originalPrice = parseFloat(document.getElementById('price').value);

    if (promoCode === 'tasty') {
        const discountedPrice = originalPrice * 0.8; // 20% off

        // Update the hidden input field with the discounted price
        document.getElementById('price').value = discountedPrice.toFixed(2);

        // Update the total price displayed on the page
        document.getElementById('totalPrice').textContent = `$${discountedPrice.toFixed(2)}`;

        alert('Code is correct. You got 20% off!');
    } else {
        // Reset to the original price when the promo code is not valid
        resetToOriginalPrice();
        alert('Invalid promo code. Please try again.');
    }
}

function resetToOriginalPrice() {
    const priceInput = document.getElementById('price');
    const totalPriceElement = document.getElementById('totalPrice');
    
    const originalPrice = parseFloat(priceInput.value);

    priceInput.value = originalPrice.toFixed(2);
    totalPriceElement.textContent = `$${originalPrice.toFixed(2)}`;
}

function placeOrder() {
    const nameInput = document.getElementById('name').value.trim();
    const surnameInput = document.getElementById('surname').value.trim();
    const addressInput = document.getElementById('address').value.trim();
    const paymentMethodInput = document.getElementById('paymentMethod').value;

    if (nameInput && surnameInput && addressInput) {
        window.location.href = "https://dhurka2.github.io/webPROJECT/HTML/thankyou.html";
    } else {
        alert('Please fill in all the required information.');
    }
}

  </script>

</body>
</html>

